<HTML>

<BODY>

<canvas width="10000" height="10000" id="can1">
</canvas>

<script>


    var canvas = document.getElementById("can1");
    var ctx = canvas.getContext('2d');

    ctx.clearRect(0, 0, 1000, 1000);

    let img = new Image;
    img.crossOrigin = "anonymus";
    img.src = "https://avatanplus.com/files/effects/original/583eb65914425158b4f84bfb.jpg"; // Change your file NAME or URL if you want

    let width = img.width;
    let height = img.height;

    let imgData2= new ImageData(width,height);
    let imgData2x= new ImageData(width,height);
    let imgData2y= new ImageData(width,height);

    let x0 = 0, y0 = 0;

    function grayScaling() {
        ctx.drawImage(img, x0, y0);
        var imgData = ctx.getImageData(x0, y0, width, height);


    }


    img.onload = function sobelFiltering() {
        ctx.drawImage(img, 0, 0);
        let imgData = ctx.getImageData(0, 0, width, height);

        for (let i = 0; i < imgData.data.length; i += 4) {
            let gray = (imgData.data[i] + imgData.data[i + 1] + imgData.data[i + 2]) / 3;
            imgData.data[i] = gray;
            imgData.data[i + 1] = gray;
            imgData.data[i + 2] = gray;
        }
        ctx.putImageData(imgData, x0, y0+height+10);


        for (let y = 0; y < height; y++) {
            for (let x = 0; x < width; x++) {

                let a11 = 255, a12 = 255, a13 = 255, a21 = 255, a22 = 255, a23 = 255, a31 = 255, a32 = 255, a33 = 255;

                if (x - 1 >= 0 && y - 1 >= 0)
                    a11 = imgData.data[4 * ((x - 1) + width * (y - 1))];
                if (y - 1 >= 0)
                    a12 = imgData.data[4 * (x + width * (y - 1))];
                if (x + 1 <= img.width - 1 && y - 1 >= 0)
                    a13 = imgData.data[4 * ((x + 1) + width * (y - 1))];
                if (x - 1 >= 0)
                    a21 = imgData.data[4 * ((x - 1) + width * y)];
                a22 = imgData.data[4 * (x + width * y)];
                if (x + 1 <= img.width - 1)
                    a23 = imgData.data[4 * ((x + 1) + width * y)];
                if (x - 1 >= 0 && y + 1 <= img.height - 1)
                    a31 = imgData.data[4 * ((x - 1) + width * (y + 1))];
                if (y + 1 <= img.height - 1)
                    a32 = imgData.data[4 * (x + width * (y + 1))];
                if (x + 1 <= img.width - 1 && y + 1 <= img.height - 1)
                    a33 = imgData.data[4 * ((x + 1) + width * (y + 1))];


                let Gy = ((a11 * (-1) + a12 * (-2) + a13 * (-1) + a31 * (1) + a32 * (2) + a33 * (1)));
                let Gx = ((a11 * (-1) + a13 * (1) + a21 * (-2) + a23 * (2) + a31 * (-1) + a33 * (1)));
                let G = Math.sqrt(Gx * Gx + Gy * Gy);

                imgData2.data[4 * (x + width * y)] = G;
                imgData2.data[4 * (x + width * y) + 1] = G;
                imgData2.data[4 * (x + width * y) + 2] = G;
                imgData2.data[4 * (x + width * y) + 3] = 255;

                imgData2x.data[4 * (x + width * y)] = Gx;
                imgData2x.data[4 * (x + width * y) + 1] = Gx;
                imgData2x.data[4 * (x + width * y) + 2] = Gx;
                imgData2x.data[4 * (x + width * y) + 3] = 255;

                imgData2y.data[4 * (x + width * y)] = Gy;
                imgData2y.data[4 * (x + width * y) + 1] = Gy;
                imgData2y.data[4 * (x + width * y) + 2] = Gy;
                imgData2y.data[4 * (x + width * y) + 3] = 255;


            }
        }
        ctx.putImageData(imgData2, x0+width+50, y0);
        ctx.putImageData(imgData2x, x0, y0 + height * 2 + 40);
        ctx.putImageData(imgData2y, x0, y0 + height * 3 + 70);


    }

</script>
</BODY>
</HTML>
